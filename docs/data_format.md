# 数据格式要求

为确保抵押贷款定价比较工具能够正确解析和处理您的数据，请按照以下格式要求准备Excel文件。

## Excel文件要求

工具需要两个Excel文件：
1. **AAA DSCR文件** - 包含AAA标准定价表
2. **投资者DSCR文件** - 包含投资者定价表

## 表格结构

### LLPA调整表

每个Excel文件应包含多个LLPA（Loan Level Price Adjustment）调整表，每个表格应具有以下结构：

1. **模块标题**：每个模块应有明确的标题，格式为"数字. 维度名称"，例如：
   - "1. FICO/LTV"
   - "2. DSCR"
   - "3. Loan Amount"

2. **表格结构**：
   - 第一列：条件名称（例如FICO分数范围、DSCR值等）
   - 表头行：LTV范围（例如"65-70%"、"<=65%"）
   - 单元格值：对应条件和LTV范围的价格调整值

示例：
```
1. FICO/LTV
           <=65%    65-70%    70-75%    75-80%
740+        0.000    0.000     0.125     0.250
720-739     0.125    0.250     0.375     0.500
700-719     0.250    0.375     0.500     0.750
680-699     0.375    0.500     0.750     1.000
```

### 基础价格表

每个Excel文件还应包含基础价格表，具有以下结构：

1. **表格标题**：应包含"Base Price"字样

2. **表格结构**：
   - 一列包含利率值（例如4.500、4.625、4.750等）
   - 一列包含对应的基础价格值（例如102.125、101.875等）

示例：
```
Rate    Base Price
4.500   102.125
4.625   101.875
4.750   101.625
4.875   101.375
5.000   101.125
```

## 命名约定

为了正确识别和处理表格，请遵循以下命名约定：

1. **AAA表格**：AAA表格的工作表名称应以"S-AAA"开头，例如：
   - "S-AAA DSCR"
   - "S-AAA 30Y Fixed"

2. **投资者表格**：投资者表格的工作表名称应以"S-"开头，后跟投资者名称，例如：
   - "S-Investor A"
   - "S-Investor B"

## 数据验证规则

工具会执行以下验证检查：

1. **模块一致性**：投资者表格应包含与AAA表格相同的模块
2. **模块顺序**：模块应按照与AAA表格相同的顺序排列
3. **LTV范围**：每个模块的LTV范围应与AAA表格匹配
4. **基础价格行**：投资者表格应包含与AAA表格相同的利率行

## 数据准备建议

1. **保持一致性**：确保所有表格使用一致的格式和命名约定
2. **避免合并单元格**：合并单元格可能导致解析错误
3. **避免空行和空列**：在表格中间避免使用空行或空列
4. **使用标准格式**：使用标准的数字格式（例如，使用小数点而不是逗号）
5. **检查完整性**：确保所有必要的模块和数据都已包含

## 示例文件

参考提供的示例文件：
- `AAA DSCR.xlsx`
- `Investor DSCR.xlsx`

这些示例文件展示了正确的格式和结构，可以作为准备自己数据的模板。

## 常见问题

1. **为什么我的文件无法正确解析？**
   - 检查模块标题格式是否正确
   - 确保LTV范围格式一致
   - 验证基础价格表是否包含正确的列

2. **为什么结构验证显示缺失模块？**
   - 确保投资者表格包含与AAA表格相同的所有模块
   - 检查模块名称是否完全匹配

3. **为什么某些利率没有价格？**
   - 确保基础价格表包含所有必要的利率
   - 检查是否有缺失的数据点
